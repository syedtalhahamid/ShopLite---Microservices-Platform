---
- name: Bootstrap Jenkins Server with Docker & kubectl
  hosts: jenkins
  become: yes

  tasks:
    - name: Update apt cache
      apt: update_cache=yes

    - name: Install Docker
      apt: name=docker.io state=present

    - name: Install Docker Compose
      apt: name=docker-compose state=present

    - name: Add jenkins user to docker group
      user: name=jenkins groups=docker append=yes

    - name: Install kubectl
      get_url:
        url: https://storage.googleapis.com/kubernetes-release/release/v1.27.0/bin/linux/amd64/kubectl
        dest: /usr/local/bin/kubectl
        mode: '0755'
